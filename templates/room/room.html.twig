{# templates/room/room.html.twig #}

{% extends "base.html.twig" %}

{% block body %}
{% block navbar %}{{ parent() }}{% endblock %}

<div class="room-container">
    <header class="room-header">
        <span class="badge {{ room.difficulty.value }}">
            {{ room.difficulty.value|upper }} MODE
        </span>
        <h1>ROOM_{{ room.number|format('%02d') }}</h1>
    </header>

    <main class="challenge-container">
        <div class="puzzle-content">
            {% if room.component %}
                <iframe 
                    src="{{ asset('uploads/components/' ~ room.component) }}" 
                    style="width: 100%; height: 600px; border: none; background: #fff;"
                    sandbox="allow-scripts allow-forms">
                </iframe>
            {% else %}
                <p>No component uploaded for this room.</p>
            {% endif %}
        </div>

        <div class="message-container mt-3">
            
            {% for message in app.flashes('success') %}
                <div class="alert alert-success shadow-sm border-0 animate__animated animate__fadeIn">
                    {{ message }}
                </div>
            {% endfor %}

        
            {% for message in app.flashes('error') %}
                <div class="alert alert-danger shadow-sm border-0 animate__animated animate__fadeIn">
                    {{ message }}
                </div>
            {% endfor %}
        </div>

        <section class="flag-submission mt-4">
            <form action="{{ path('submitFlag', {id: room.id}) }}" method="POST">
                <div class="input-group">
                    <input type="text" name="submitted_flag" class="form-control" placeholder="CTF{...}" required>
                    <button class="btn btn-primary" type="submit">SUBMIT</button>
                </div>
            </form>
        </section>
    </main>

    <footer class="room-actions">
        <a href="{{ path('home') }}" class="back-btn">RETURN TO GRID</a>
    </footer>
</div>
{% endblock %}